

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T·∫°o B√°o C√°o Th·∫ßu X√¢y D·ª±ng</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        .section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        
        .section-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2874a6;
            padding-bottom: 5px;
            border-bottom: 1px solid #ddd;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input[type="text"], input[type="date"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        button {
            background-color: #2e86c1;
            color: white;
            border: none;
            padding: 12px 20px;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            display: block;
            margin: 20px auto;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #1a5276;
        }
        
        .preview-container {
            display: none;
            margin-top: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: white;
        }
        
        .document {
            font-family: 'Times New Roman', serif;
            line-height: 1.6;
            width: 100%;
            margin: 0 auto;
            font-size: 14pt;
            text-align: left;
        }
        
        .document-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0;
        }
        
        .document-header-left, .document-header-right {
            width: 48%;
        }
        
        .document-header-left div, .document-header-right div {
            margin-bottom: 5px;
        }
        
        .document-republic {
            text-align: center;
            font-weight: bold;
            text-transform: uppercase;
            margin-bottom: 5pt;
            font-size: 13pt !important;
            /* ƒê√£ s·ª≠a: B·ªè g·∫°ch ch√¢n */
        }
        
        .document-independence {
            text-align: center;
            font-weight: bold;
            margin-bottom: 0; /* ƒê√£ s·ª≠a: Gi·∫£m spacing after th√†nh 0px */
            text-decoration: underline;
        }
        
        .document-number {
            /* Vi·∫øt th∆∞·ªùng in th∆∞·ªùng */
        }
        
        .document-location-date {
            text-align: center;
        }
        
        .document-title {
            text-align: center;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .document-project {
            text-align: center;
            font-weight: bold;

        }
        
        .document-subtitle {
            text-align: center;
        }
        
        .document-commander {
            text-align: center;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .document-basis {
            text-align: justify;
            margin-bottom: 6px;
            font-style: italic;
        }
        
        .document-decision {
            text-align: center;
            font-weight: bold;
            text-transform: uppercase;
            margin: 20pt 0 10pt;
        }
        
        .document-article {
            text-align: justify;
            margin-bottom: 10pt;
            text-indent: 1cm;
        }
        
        .document-article-title {
            font-weight: bold;
            display: inline;
        }
        
        .document-article-content {
            display: inline;
        }
        
        .document-footer {
            display: flex;
            justify-content: space-between;
            margin-top: 0;
        }
        
        .document-recipient, .document-signature {
            width: 48%;
        }
        
        .document-recipient-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-style: italic;
            font-size: 15px;
        }
        
        .document-recipient-list {
            margin-left: 20px;
            font-size: 11px !important;
        }
        
        .document-signature-title {
            text-transform: uppercase;
            font-weight: bold;
            text-align: center;
            margin-top: 50px;
            font-size: 14pt !important;
        }
        
        .document-signature-name {
            text-align: center;
            font-weight: bold;
            margin-top: 50px;
            font-size: 14pt !important;
        }
        
        .back-button {
            background-color: #7d7d7d;
        }
        
        .back-button:hover {
            background-color: #5c5c5c;
        }
        
        .download-button {
            background-color: #27ae60;
            margin-right: 10px;
        }
        
        .download-button:hover {
            background-color: #219653;
        }
        
        .save-button {
            background-color: #e67e22;
        }
        
        .save-button:hover {
            background-color: #d35400;
        }
        
        .saved-documents {
            margin-top: 30px;
            border-top: 1px solid #ddd;
            padding-top: 20px;
        }
        
        .saved-documents h3 {
            margin-bottom: 15px;
            color: #1a5276;
        }
        
        .document-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .document-item {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            background-color: #f9f9f9;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .document-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .document-item h4 {
            margin-bottom: 10px;
            color: #2874a6;
        }
        
        .document-item p {
            color: #666;
            font-size: 14px;
        }
        
        .storage-container {
            display: none;
            margin-top: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: white;
        }
        
        .storage-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }
        
        .storage-title {
            font-size: 24px;
            color: #2874a6;
        }
        
        .storage-actions {
            display: flex;
            gap: 10px;
        }
        
        .storage-action-button {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .storage-back-button {
            background-color: #7d7d7d;
            color: white;
        }
        
        .storage-back-button:hover {
            background-color: #5c5c5c;
        }
        
        .storage-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .storage-item {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 20px;
            background-color: #f9f9f9;
            transition: transform 0.2s;
        }
        
        .storage-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .storage-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .storage-item-title {
            font-size: 18px;
            color: #2874a6;
            margin-bottom: 5px;
        }
        
        .storage-item-date {
            color: #666;
            font-size: 14px;
        }
        
        .storage-item-content {
            margin-bottom: 15px;
            color: #444;
        }
        
        .storage-item-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .storage-item-view-button {
            background-color: #2e86c1;
            color: white;
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .storage-item-view-button:hover {
            background-color: #1a5276;
        }
        
        .storage-item-word-button {
            background-color: #27ae60;
            color: white;
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .storage-item-word-button:hover {
            background-color: #219653;
        }
        
        .storage-item-delete-button {
            background-color: #e74c3c;
            color: white;
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .storage-item-delete-button:hover {
            background-color: #c0392b;
        }
        
        .empty-storage {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .empty-storage-icon {
            font-size: 48px;
            margin-bottom: 15px;
            color: #ddd;
        }
        
        .empty-storage-text {
            font-size: 18px;
        }

        @media print {
            .container, button, .saved-documents, .storage-container {
                display: none;
            }
            .preview-container {
                display: block;
                border: none;
                padding: 0;
                box-shadow: none;
            }
            .document {
                page-break-after: always;
            }
        }
        
        /* CƒÉn ch·ªânh ƒë·∫∑c bi·ªát cho ph·∫ßn header */
        .header-left-content, .header-right-content {
            font-size: 13pt !important;
        }
        
        /* ƒê·∫£m b·∫£o c√°c ph·∫ßn t·ª≠ c√≥ text-align: left */
        .left-align {
            text-align: left !important;
        }
        
        /* ƒê·∫£m b·∫£o c√°c ƒëo·∫°n vƒÉn c√≥ th·ª•t ƒë·∫ßu d√≤ng */
        .text-indent {
            text-indent: 1cm;
        }
        
        /* Style cho b·∫£ng trong header */
        .header-table {
            width: 100%;
            border-collapse: collapse;
            border: none;
            margin-bottom: 0;
        }
        
        .header-table td {
            vertical-align: top;
            padding: 0;
            border: none;
            height: 15pt;
        }
        
        .header-left {
            width: 27%; /* ƒê√£ s·ª≠a: Gi·∫£m k√≠ch th∆∞·ªõc c·ªôt tr√°i c√≤n 2/3 (40% * 2/3 ‚âà 27%) */
            text-align: center; /* ƒê√£ s·ª≠a: CƒÉn gi·ªØa to√†n b·ªô n·ªôi dung */
        }
        
        .header-middle {
            width: 5%;
            text-align: center;
        }
        
        .header-right {
            width: 68%; /* ƒê√£ s·ª≠a: TƒÉng k√≠ch th∆∞·ªõc c·ªôt ph·∫£i ƒë·ªÉ b√π l·∫°i */
            text-align: right;
        }
        
        /* Style cho b·∫£ng trong footer */
        .footer-table {
            width: 100%;
            border-collapse: collapse;
            border: none;
            margin-top: 0;
        }
        
        .footer-table td {
            vertical-align: top;
            padding: 0;
            border: none;
            height: 15pt;
        }
        
        .footer-left {
            width: 50%;
            text-align: left;
        }
        
        .footer-middle {
            width: 10%;
            text-align: center;
        }
        
        .footer-right {
            width: 40%;
            text-align: right;
        }
        
        .footer-recipient {
            margin-left: 13px;
        }
        
        .footer-signature {
            text-align: center;
        }
        
        .signature-row {
            height: 30pt;
        }
        
        .signature-title {
            text-transform: uppercase;
            font-weight: bold;
            font-size: 14pt;
            margin-bottom: 40pt;
        }
        
        .signature-name {
            font-weight: bold;
            font-size: 14pt;
        }
        
        /* Style cho S∆Ø ƒêO√ÄN 10 in ƒë·∫≠m v√† g·∫°ch ch√¢n */
        .division-name {
            font-weight: bold;
            text-decoration: underline;
            text-align: center;
        }
    </style>
    <!-- Th√™m th∆∞ vi·ªán html2pdf -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <div class="container">
        <div id="inputForm">
            <div class="section">
                <div class="section-title">A. TH√îNG TIN CHUNG</div>
                
                <div class="form-group">
                    <label for="projectName">I. T√™n d·ª± √°n</label>
                    <input type="text" id="projectName" placeholder="Nh·∫≠p t√™n d·ª± √°n">
                </div>
                
                <div class="form-group">
                    <label for="packageCode">III. G√≥i th·∫ßu</label>
                    <input type="text" id="packageCode" value="XL - 07" readonly>
                </div>
                
                <div class="form-group">
                    <label for="packageName">1. T√™n g√≥i th·∫ßu</label>
                    <input type="text" id="packageName" placeholder="Nh·∫≠p t√™n g√≥i th·∫ßu">
                </div>
                
                <div class="form-group">
                    <label for="packageContent">2. N·ªôi dung g√≥i th·∫ßu</label>
                    <input type="text" id="packageContent" placeholder="Nh·∫≠p n·ªôi dung g√≥i th·∫ßu">
                </div>
                
                <div class="form-group">
                    <label for="packageDetails">3. Chi ti·∫øt g√≥i th·∫ßu</label>
                    <input type="text" id="packageDetails" placeholder="Nh·∫≠p chi ti·∫øt g√≥i th·∫ßu">
                </div>
                
                <div class="form-group">
                    <label for="decisionNumber">4. S·ªë quy·∫øt ƒë·ªãnh</label>
                    <input type="text" id="decisionNumber" placeholder="Nh·∫≠p s·ªë quy·∫øt ƒë·ªãnh">
                </div>
                
                <div class="form-group">
                    <label for="decisionDate">5. Th·ªùi gian ban h√†nh</label>
                    <input type="date" id="decisionDate">
                </div>
                
                <div class="form-group">
                    <label for="bidWinner">6. T√™n ƒë∆°n v·ªã tr√∫ng th·∫ßu</label>
                    <input type="text" id="bidWinner" placeholder="Nh·∫≠p t√™n ƒë∆°n v·ªã tr√∫ng th·∫ßu">
                </div>
                
                <div class="form-group">
                    <label for="address">7. ƒê·ªãa ch·ªâ</label>
                    <input type="text" id="address" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ">
                </div>
                
                <div class="form-group">
                    <label for="bidValue">8. Gi√° tr√∫ng th·∫ßu (ƒë·ªìng)</label>
                    <input type="text" id="bidValue" placeholder="Nh·∫≠p gi√° tr√∫ng th·∫ßu">
                </div>
            </div>
            
            <button id="generateButton">T·∫†O B√ÅO C√ÅO</button>
            <button id="viewStorageButton" style="background-color: #8e44ad;">XEM B√ÅO C√ÅO ƒê√É L∆ØU</button>
        </div>
        
        <div id="previewContainer" class="preview-container">
            <div id="documentContent" class="document">
                <!-- N·ªôi dung b√°o c√°o s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y -->
            </div>
            
            <div style="display: flex; justify-content: center; margin-top: 20px;">
                <button id="backButton" class="back-button">QUAY L·∫†I</button>
                <button id="downloadButton" class="download-button">T·∫¢I XU·ªêNG (WORD)</button>
                <button id="saveButton" class="save-button">L∆ØU B√ÅO C√ÅO</button>
            </div>
            
            <div id="savedDocuments" class="saved-documents">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="margin: 0;">B√ÅO C√ÅO ƒê√É L∆ØU</h3>
                    <button id="viewStorageFromPreview" class="view-storage-button" style="background-color: #8e44ad; color: white; padding: 8px 15px; border: none; border-radius: 4px; cursor: pointer;">
                        XEM T·∫§T C·∫¢ B√ÅO C√ÅO
                    </button>
                </div>
                <div id="documentList" class="document-list">
                    <!-- Danh s√°ch c√°c b√°o c√°o ƒë√£ l∆∞u s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y -->
                </div>
            </div>
        </div>
        
        <div id="storageContainer" class="storage-container">
            <div class="storage-header">
                <h2 class="storage-title">KHO L∆ØU TR·ªÆ B√ÅO C√ÅO</h2>
                <div class="storage-actions">
                    <button id="storageBackButton" class="storage-action-button storage-back-button">QUAY L·∫†I</button>
                </div>
            </div>
            
            <div id="storageList" class="storage-list">
                <!-- Danh s√°ch b√°o c√°o trong kho l∆∞u tr·ªØ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y -->
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const generateButton = document.getElementById('generateButton');
            const viewStorageButton = document.getElementById('viewStorageButton');
            const backButton = document.getElementById('backButton');
            const storageBackButton = document.getElementById('storageBackButton');
            const downloadButton = document.getElementById('downloadButton');
            const saveButton = document.getElementById('saveButton');
            const inputForm = document.getElementById('inputForm');
            const previewContainer = document.getElementById('previewContainer');
            const storageContainer = document.getElementById('storageContainer');
            const documentContent = document.getElementById('documentContent');
            const documentList = document.getElementById('documentList');
            const storageList = document.getElementById('storageList');
            const savedDocuments = document.getElementById('savedDocuments');
            const viewStorageFromPreview = document.getElementById('viewStorageFromPreview');
            
            // Kh·ªüi t·∫°o danh s√°ch b√°o c√°o ƒë√£ l∆∞u t·ª´ localStorage
            let savedReports = JSON.parse(localStorage.getItem('savedReports')) || [];
            renderSavedReports();
            renderStorageReports();
            
            // H√†m chuy·ªÉn ƒë·ªïi s·ªë th√†nh ch·ªØ
            function numberToWords(number) {
                const units = ['', 'm·ªôt', 'hai', 'ba', 'b·ªën', 'nƒÉm', 's√°u', 'b·∫£y', 'b·∫£y', 'ch√≠n'];
                const positions = ['', 'ngh√¨n', 'tri·ªáu', 't·ª∑', 'ngh√¨n t·ª∑', 'tri·ªáu t·ª∑'];
                
                if (number === 0) return 'kh√¥ng';
                
                let words = '';
                let position = 0;
                
                do {
                    const block = number % 1000;
                    if (block !== 0) {
                        words = readBlock(block) + ' ' + positions[position] + ' ' + words;
                    }
                    position++;
                    number = Math.floor(number / 1000);
                } while (number > 0);
                
                return words.trim() + ' ƒë·ªìng';
            }
            
            function readBlock(number) {
                const units = ['', 'm·ªôt', 'hai', 'ba', 'b·ªën', 'nƒÉm', 's√°u', 'b·∫£y', 'b·∫£y', 'ch√≠n'];
                const tens = ['', 'm∆∞·ªùi', 'hai m∆∞∆°i', 'ba m∆∞∆°i', 'b·ªën m∆∞∆°i', 'nƒÉm m∆∞∆°i', 's√°u m∆∞∆°i', 'b·∫£y m∆∞∆°i', 'b·∫£y m∆∞∆°i', 'ch√≠n m∆∞∆°i'];
                const hundreds = ['', 'm·ªôt trƒÉm', 'hai trƒÉm', 'ba trƒÉm', 'b·ªën trƒÉm', 'nƒÉm trƒÉm', 's√°u trƒÉm', 'b·∫£y trƒÉm', 'b·∫£y trƒÉm', 'ch√≠n trƒÉm'];
                
                let result = '';
                const hundred = Math.floor(number / 100);
                const ten = Math.floor((number % 100) / 10);
                const unit = number % 10;
                
                if (hundred > 0) {
                    result += hundreds[hundred] + ' ';
                }
                
                if (ten > 0) {
                    result += tens[ten] + ' ';
                    if (unit > 0) {
                        if (unit === 1 && ten > 1) {
                            result += 'm·ªët';
                        } else if (unit === 5 && ten > 0) {
                            result += 'lƒÉm';
                        } else {
                            result += units[unit];
                        }
                    }
                } else if (unit > 0) {
                    result += units[unit];
                } else if (ten === 1) {
                    result += 'm∆∞·ªùi';
                }
                
                return result.trim();
            }
            
            // H√†m ƒë·ªãnh d·∫°ng ng√†y th√°ng
            function formatDate(dateString) {
                const date = new Date(dateString);
                const day = date.getDate().toString().padStart(2, '0');
                const month = (date.getMonth() + 1).toString().padStart(2, '0');
                const year = date.getFullYear();
                
                return `ng√†y ${day} th√°ng ${month} nƒÉm ${year}`;
            }
            
            // H√†m hi·ªÉn th·ªã danh s√°ch b√°o c√°o ƒë√£ l∆∞u
            function renderSavedReports() {
                documentList.innerHTML = '';
                
                if (savedReports.length === 0) {
                    documentList.innerHTML = '<p>Ch∆∞a c√≥ b√°o c√°o n√†o ƒë∆∞·ª£c l∆∞u.</p>';
                    return;
                }
                
                // Ch·ªâ hi·ªÉn th·ªã 3 b√°o c√°o g·∫ßn nh·∫•t
                const recentReports = [...savedReports].reverse().slice(0, 3);
                
                recentReports.forEach((report, index) => {
                    const reportItem = document.createElement('div');
                    reportItem.className = 'document-item';
                    reportItem.innerHTML = `
                        <h4>B√°o c√°o ${savedReports.length - index}</h4>
                        <p>D·ª± √°n: ${report.projectName}</p>
                        <p>Ng√†y t·∫°o: ${new Date(report.timestamp).toLocaleDateString('vi-VN')}</p>
                    `;
                    
                    reportItem.addEventListener('click', () => {
                        documentContent.innerHTML = report.content;
                        inputForm.style.display = 'none';
                        previewContainer.style.display = 'block';
                        storageContainer.style.display = 'none';
                    });
                    
                    documentList.appendChild(reportItem);
                });
            }
            
            // H√†m hi·ªÉn th·ªã danh s√°ch b√°o c√°o trong kho l∆∞u tr·ªØ
            function renderStorageReports() {
                storageList.innerHTML = '';
                
                if (savedReports.length === 0) {
                    storageList.innerHTML = `
                        <div class="empty-storage">
                            <div class="empty-storage-icon">üìÅ</div>
                            <div class="empty-storage-text">Kho l∆∞u tr·ªØ tr·ªëng</div>
                        </div>
                    `;
                    return;
                }
                
                // Hi·ªÉn th·ªã t·∫•t c·∫£ b√°o c√°o theo th·ª© t·ª± m·ªõi nh·∫•t l√™n ƒë·∫ßu
                const reversedReports = [...savedReports].reverse();
                
                reversedReports.forEach((report, index) => {
                    const reportItem = document.createElement('div');
                    reportItem.className = 'storage-item';
                    reportItem.innerHTML = `
                        <div class="storage-item-header">
                            <div>
                                <h3 class="storage-item-title">B√°o c√°o ${reversedReports.length - index}</h3>
                                <p class="storage-item-date">Ng√†y t·∫°o: ${new Date(report.timestamp).toLocaleDateString('vi-VN')} - ${new Date(report.timestamp).toLocaleTimeString('vi-VN')}</p>
                            </div>
                        </div>
                        <div class="storage-item-content">
                            <p><strong>D·ª± √°n:</strong> ${report.projectName}</p>
                            <p><strong>G√≥i th·∫ßu:</strong> ${report.packageCode || 'XL - 07'}</p>
                            <p><strong>ƒê∆°n v·ªã tr√∫ng th·∫ßu:</strong> ${report.bidWinner || 'Ch∆∞a c√≥ th√¥ng tin'}</p>
                        </div>
                        <div class="storage-item-actions">
                            <button class="storage-item-view-button" data-id="${report.id}">XEM</button>
                            <button class="storage-item-word-button" data-id="${report.id}">WORD</button>
                            <button class="storage-item-delete-button" data-id="${report.id}">X√ìA</button>
                        </div>
                    `;
                    
                    storageList.appendChild(reportItem);
                });
                
                // Th√™m s·ª± ki·ªán cho c√°c n√∫t
                document.querySelectorAll('.storage-item-view-button').forEach(button => {
                    button.addEventListener('click', function() {
                        const reportId = this.getAttribute('data-id');
                        const report = savedReports.find(r => r.id === reportId);
                        if (report) {
                            documentContent.innerHTML = report.content;
                            inputForm.style.display = 'none';
                            previewContainer.style.display = 'block';
                            storageContainer.style.display = 'none';
                        }
                    });
                });
                
                document.querySelectorAll('.storage-item-word-button').forEach(button => {
                    button.addEventListener('click', function() {
                        const reportId = this.getAttribute('data-id');
                        const report = savedReports.find(r => r.id === reportId);
                        if (report) {
                            downloadReportAsWord(report);
                        }
                    });
                });
                
                document.querySelectorAll('.storage-item-delete-button').forEach(button => {
                    button.addEventListener('click', function() {
                        const reportId = this.getAttribute('data-id');
                        if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a b√°o c√°o n√†y?')) {
                            deleteReport(reportId);
                        }
                    });
                });
            }
            
            // H√†m x√≥a b√°o c√°o
            function deleteReport(reportId) {
                savedReports = savedReports.filter(report => report.id !== reportId);
                localStorage.setItem('savedReports', JSON.stringify(savedReports));
                renderSavedReports();
                renderStorageReports();
                alert('B√°o c√°o ƒë√£ ƒë∆∞·ª£c x√≥a th√†nh c√¥ng!');
            }
            
            // H√†m t·∫£i b√°o c√°o d∆∞·ªõi d·∫°ng Word
            function downloadReportAsWord(report) {
                const content = report.content;
                
                // T·∫°o n·ªôi dung HTML cho file Word
                const wordContent = `
                    <!DOCTYPE html>
                    <html lang="vi">
                    <head>
                        <meta charset="UTF-8">
                        <title>B√°o C√°o Th·∫ßu X√¢y D·ª±ng</title>
                        <style>
                            @page {
                                size: A4;
                                margin: 1cm;
                            }
                            body {
                                font-family: 'Times New Roman', serif;
                                line-height: 1.6;
                                font-size: 14pt;
                                margin: 0;
                                padding: 0;
                                width: 100%;
                                text-align: left;
                            }
                            .header-table {
                                width: 100%;
                                border-collapse: collapse;
                                border: none;
                                margin-bottom: 0;
                            }
                            .header-table td {
                                vertical-align: top;
                                padding: 0;
                                border: none;
                                height: 15pt;
                            }
                            .header-left {
                                width: 27%;
                                text-align: center;
                            }
                            .header-middle {
                                width: 5%;
                                text-align: center;
                            }
                            .header-right {
                                width: 68%;
                                text-align: right;
                            }
                            .footer-table {
                                width: 100%;
                                border-collapse: collapse;
                                border: none;
                                margin-top: 0;
                            }
                            .footer-table td {
                                vertical-align: top;
                                padding: 0;
                                border: none;
                                height: 15pt;
                            }
                            .footer-left {
                                width: 50%;
                                text-align: left;
                            }
                            .footer-middle {
                                width: 10%;
                                text-align: center;
                            }
                            .footer-right {
                                width: 40%;
                                text-align: right;
                            }
                            .footer-recipient {
                                margin-left: 13px;
                            }
                            .footer-signature {
                                text-align: center;
                            }
                            .signature-row {
                                height: 30pt;
                            }
                            .signature-title {
                                text-transform: uppercase;
                                font-weight: bold;
                                font-size: 14pt;
                                margin-bottom: 40pt;
                            }
                            .signature-name {
                                font-weight: bold;
                                font-size: 14pt;
                            }
                            .document-republic {
                                text-align: center;
                                font-weight: bold;
                                text-transform: uppercase;
                                margin-bottom: 5pt;
                                font-size: 13pt;
                            }
                            .document-independence {
                                text-align: center;
                                font-weight: bold;
                                margin-bottom: 0;
                                text-decoration: underline;
                            }
                            .document-number {
                                /* Vi·∫øt th∆∞·ªùng in th∆∞·ªùng */
                            }
                            .document-location-date {
                                text-align: center;
                            }
                            .document-title {
                                text-align: center;
                                font-weight: bold;
                                text-transform: uppercase;
                            }
                            .document-project {
                                text-align: center;
                                font-weight: bold;

                            }
                            .document-subtitle {
                                text-align: center;
                                font-weight: bold;
                            }
                            .document-commander {
                                text-align: center;
                                font-weight: bold;
                                text-transform: uppercase;
                            }
                            .document-basis {
                                text-align: left;
                                margin-bottom: 6px;
                                font-style: italic;
                                text-indent: 1cm;
                            }
                            .document-decision {
                                text-align: center;
                                font-weight: bold;
                                text-transform: uppercase;
                                margin: 20pt 0 10pt;
                            }
                            .document-article {
                                text-align: left;
                                margin-bottom: 10pt;
                                text-indent: 1cm;
                            }
                            .document-article-title {
                                font-weight: bold;
                                display: inline;
                            }
                            .document-article-content {
                                display: inline;
                            }
                            p {
                                text-align: left;
                                text-indent: 1cm;
                                margin-bottom: 10pt;
                            }
                            .left-align {
                                text-align: left;
                            }
                            .text-indent {
                                text-indent: 1cm;
                            }
                            .division-name {
                                font-weight: bold;
                                text-decoration: underline;
                                text-align: center;
                            }
                            .document-recipient-title {
                                font-weight: bold;
                                margin-bottom: 10px;
                                font-style: italic;
                                font-size: 15px;
                            }
                            .document-recipient-list {
                                margin-left: 20px;
                                font-size: 11px !important;
                            }
                        </style>
                    </head>
                    <body>
                        ${content}
                    </body>
                    </html>
                `;
                
                // T·∫°o file Word b·∫±ng c√°ch s·ª≠ d·ª•ng Blob v√† download
                const blob = new Blob(['\ufeff', wordContent], { type: 'application/msword' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `Bao_Cao_Thau_Xay_Dung_${report.id.slice(0, 8)}.doc`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
            }
            
            // H√†m t·∫°o b√°o c√°o
            generateButton.addEventListener('click', function() {
                // L·∫•y gi√° tr·ªã t·ª´ form
                const projectName = document.getElementById('projectName').value || 'Doanh tr·∫°i Trung ƒëo√†n b·ªô binh 24/S∆∞ ƒëo√†n b·ªô binh 10 (Giai ƒëo·∫°n 2)';
                const packageCode = document.getElementById('packageCode').value;
                const packageName = document.getElementById('packageName').value || 'Thi c√¥ng x√¢y d·ª±ng h·∫°ng m·ª•c: Thi c√¥ng x√¢y d·ª±ng s·ªë 6 Kon Tum v√° C√¥ngty TNHH x√¢y d·ª±ng s·ªë 6 Kon Tum';
                const packageContent = document.getElementById('packageContent').value;
                const packageDetails = document.getElementById('packageDetails').value || 'N·ªôi dung c√¥ng vi·ªác: Thi c√¥ng x√¢y d·ª±ng c√°c h·∫°ng m·ª•c c√¥ng tr√¨nh theo h·ªì s∆° thi·∫øt k·∫ø b·∫£n v·∫Ω thi c√¥ng v√† d·ª± to√°n ƒë∆∞·ª£c ph√™ duy·ªát';
                const decisionNumber = document.getElementById('decisionNumber').value || '1085/Qƒê-Sƒê';
                const decisionDate = document.getElementById('decisionDate').value || '2025-09-01';
                const bidWinner = document.getElementById('bidWinner').value || 'C√¥ng ty TNHH x√¢y d·ª±ng s·ªë 6 Kon Tum';
                const address = document.getElementById('address').value || 'S·ªë 09A, ƒê∆∞·ªùng Nguy·ªÖn Tr√£i, Ph∆∞·ªùng ƒê·∫Øk C·∫•m, th√†nh ph·ªë Kon Tum, t·ªânh Kon Tum';
                const bidValue = document.getElementById('bidValue').value || '25.272.001.000';
                
                // Ki·ªÉm tra xem t·∫•t c·∫£ c√°c tr∆∞·ªùng ƒë√£ ƒë∆∞·ª£c nh·∫≠p hay ch∆∞a
                if (!projectName || !packageName || !packageContent || !packageDetails || 
                    !decisionNumber || !decisionDate || !bidWinner || !address || !bidValue) {
                    alert('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin!');
                    return;
                }
                
                // ƒê·ªãnh d·∫°ng gi√° tr·ªã
                const formattedDate = formatDate(decisionDate);
                const numericValue = parseFloat(bidValue.replace(/\./g, '').replace(',', '.'));
                const valueInWords = numberToWords(numericValue).replace(/ƒë·ªìng$/, '').trim() + ' ƒë·ªìng.';
                
                // T·∫°o n·ªôi dung b√°o c√°o v·ªõi b·ªë c·ª•c m·ªõi
                const reportContent = `
                    <table class="header-table">
                        <tr>
                            <td class="header-left">
                                <div style="text-transform: uppercase; font-size: 13pt;">QU√ÇN ƒêO√ÄN 34</div>
                                <div class="division-name" style="font-size: 13pt;">S∆Ø ƒêO√ÄN 10</div>
                                <div class="document-number" style="font-size: 10pt;">„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§</div>
                                <div class="document-number" style="font-size: 13pt;">S·ªë: ${decisionNumber}</div>
                            </td>
                            <td class="header-middle"></td>
                            <td class="header-right">
                                <div class="document-republic" style="font-size: 13pt;">C·ªòNG H√íA X√É H·ªòI CH·ª¶ NGHƒ®A VI·ªÜT NAM</div>
                                <div class="document-independence" style="font-size: 13pt;">ƒê·ªôc l·∫≠p - T·ª± do - H·∫°nh ph√∫c</div>
                                <div class="document-number" style="font-size: 10pt;">„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§</div>
                                <div class="document-location-date" style="font-size: 13pt;">Qu·∫£ng Ng√£i, ${formattedDate}</div>
                            </td>
                        </tr>
                    </table>
                    
                    <div class="document-title">„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§</div>
                     
                    <div class="document-title">QUY·∫æT ƒê·ªäNH</div>
                    
                    <div class="document-project">V/v ph√™ duy·ªát k·∫øt qu·∫£ l·ª±a ch·ªçn nh√† th·∫ßu g√≥i th·∫ßu ${packageCode}</div>
                    
                    <div class="document-subtitle">D·ª± √°n: ${projectName}</div>
                    
                    <div class="document-commander">„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§</div>
                    
                    <div class="document-commander">S∆Ø ƒêO√ÄN TR∆Ø·ªûNG S∆Ø ƒêO√ÄN 10</div>
                    
                    <div class="document-commander">„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§</div>
                    
                    <div class="document-basis text-indent" sytle ="margin-top: 10pt">
                        CƒÉn c·ª© Lu·∫≠t ƒê·∫ßu t∆∞ c√¥ng ng√†y 29/11/2024;<br>
                    </div>
                    <div class="document-basis text-indent" sytle ="margin-top: 10pt">
                        CƒÉn c·ª© Lu·∫≠t Qu·∫£n l√Ω, b·∫£o v·ªá c√¥ng tr√¨nh qu·ªëc ph√≤ng v√† khu qu√¢n s·ª± ng√†y 24/11/2023;<br>
                    </div>
                    <div class="document-basis text-indent" sytle ="margin-top: 10pt">
                        CƒÉn c·ª© Lu·∫≠t s·ªë 57/2024/QH15 ng√†y 29/11/2024 s·ª≠a ƒë·ªïi, b·ªï sung m·ªôt s·ªë ƒëi·ªÅu c·ªßa Lu·∫≠t Quy ho·∫°ch, Lu·∫≠t ƒê·∫ßu t∆∞, Lu·∫≠t ƒê·∫ßu t∆∞ theo ph∆∞∆°ng th·ª©c ƒë·ªëi t√°c c√¥ng t∆∞ v√† Lu·∫≠t ƒê·∫•u th·∫ßu;<br>
                    </div>
                    <div class="document-basis text-indent" sytle ="margin-top: 10pt">
                        CƒÉn c·ª© Lu·∫≠t s·ªë 90/2025/QH15 ng√†y 25/6/2025 s·ª≠a ƒë·ªïi, b·ªï sung m·ªôt s·ªë ƒëi·ªÅu c·ªßa Lu·∫≠t ƒê·∫•u th·∫ßu, Lu·∫≠t ƒê·∫ßu t∆∞ theo ph∆∞∆°ng th·ª©c ƒë·ªëi t√°c c√¥ng t∆∞, Lu·∫≠t H·∫£i quan, Lu·∫≠t Thu·∫ø gi√° tr·ªã gia tƒÉng, Lu·∫≠t Thu·∫ø xu·∫•t kh·∫©u, thu·∫ø nh·∫≠p kh·∫©u, Lu·∫≠t ƒê·∫ßu t∆∞, Lu·∫≠t ƒê·∫ßu t∆∞ c√¥ng, Lu·∫≠t Qu·∫£n l√Ω, s·ª≠ d·ª•ng t√†i s·∫£n c√¥ng;<br>
                    </div>
                    <div class="document-basis text-indent" sytle ="margin-top: 10pt">
                        CƒÉn c·ª© c√°c Ngh·ªã ƒë·ªãnh c·ªßa Ch√≠nh ph·ªß: S·ªë 85/2025/Nƒê-CP ng√†y 08/4/2025 quy ƒë·ªãnh chi ti·∫øt thi h√†nh m·ªôt s·ªë ƒëi·ªÅu c·ªßa Lu·∫≠t ƒê·∫ßu t∆∞ c√¥ng; s·ªë 214/2025/Nƒê-CP ng√†y 04/8/2025 quy ƒë·ªãnh chi ti·∫øt m·ªôt s·ªë ƒëi·ªÅu v√† bi·ªán ph√°p thi h√†nh Lu·∫≠t ƒê·∫•u th·∫ßu v·ªÅ l·ª±a ch·ªçn nh√† th·∫ßu; Quy·∫øt ƒë·ªãnh s·ªë 35/Qƒê-TTg ng√†y 11/3/2025 ban h√†nh Danh m·ª•c b√≠ m·∫≠t nh√† n∆∞·ªõc trong lƒ©nh v·ª±c qu·ªëc ph√≤ng;<br>
                    </div>
                    <div class="document-basis text-indent" sytle ="margin-top: 10pt">
                        CƒÉn c·ª© c√°c Th√¥ng t∆∞ c·ªßa B·ªô T√†i ch√≠nh: s·ªë 79/2025/TT-BTC ng√†y 4/8/2025 h∆∞·ªõng d·∫´n vi·ªác cung c·∫•p, ƒëƒÉng t·∫£i th√¥ng tin v·ªÅ ƒë·∫•u th·∫ßu v√† m·∫´u h·ªì s∆° ƒë·∫•u th·∫ßu tr√™n H·ªá th·ªëng m·∫°ng ƒë·∫•u th·∫ßu Qu·ªëc gia; s·ªë 80/2025/TT-BTC ng√†y 8/8/2025 quy ƒë·ªãnh chi ti·∫øt m·∫´u h·ªì s∆° y√™u c·∫ßu, b√°o c√°o ƒë√°nh gi√°, b√°o c√°o th·∫©m ƒë·ªãnh, ki·ªÉm tra, b√°o c√°o t√¨nh h√¨nh th·ª±c hi·ªán ho·∫°t ƒë·ªông ƒë·∫•u th·∫ßu;<br>
                    </div>
                    <div class="document-basis text-indent" sytle ="margin-top: 10pt">
                        CƒÉn c·ª© c√°c Th√¥ng t∆∞ c·ªßa B·ªô Qu·ªëc ph√≤ng: s·ªë 05/2021/TT-BQP ng√†y 12/01/2021 Quy ƒë·ªãnh m·ªôt s·ªë n·ªôi dung v·ªÅ l·ª±a ch·ªçn nh√† th·∫ßu trong ph·∫°m vi qu·∫£n l√Ω c·ªßa B·ªô Qu·ªëc ph√≤ng; s·ªë 74/2023/TT-BQP ng√†y 11/10/2023 S·ª≠a ƒë·ªïi, b·ªï sung m·ªôt s·ªë ƒëi·ªÅu c·ªßa Th√¥ng t∆∞ s·ªë 05/2021/TT-BQP ng√†y 12/01/2021;<br>
                    </div>
                    <div class="document-basis text-indent" sytle ="margin-top: 10pt">
                        CƒÉn c·ª© Quy·∫øt ƒë·ªãnh s·ªë 4660/Qƒê-BQP ng√†y 8/10/2024 c·ªßa B·ªô tr∆∞·ªüng B·ªô Qu·ªëc ph√≤ng v·ªÅ vi·ªác ph√™ duy·ªát ch·ªß tr∆∞∆°ng ƒë·∫ßu t∆∞ d·ª± √°n Doanh tr·∫°i Trung ƒëo√†n b·ªô binh 24/S∆∞ ƒëo√†n b·ªô binh 10 (Giai ƒëo·∫°n 2);<br>
                    </div>
                    <div class="document-basis text-indent" sytle ="margin-top: 10pt">
                        CƒÉn c·ª© c√°c Quy·∫øt ƒë·ªãnh c·ªßa T∆∞ l·ªánh Qu√¢n ƒëo√†n: s·ªë 912/Qƒê-Qƒê ng√†y 23/10/2024 v·ªÅ vi·ªác ph√™ duy·ªát d·ª± √°n; s·ªë 1128/Qƒê-Qƒê ng√†y 25/8/2025 v·ªÅ vi·ªác ph√™ duy·ªát thi·∫øt k·∫ø, d·ª± to√°n x√¢y d·ª±ng ƒë·ª£t 2; s·ªë 1129/Qƒê-Qƒê ng√†y 25/8/2025 v·ªÅ vi·ªác ph√™ duy·ªát K·∫ø ho·∫°ch l·ª±a ch·ªçn nh√† th·∫ßu ƒë·ª£t 5;<br>
                    </div>
                    <div class="document-basis text-indent" sytle ="margin-top: 10pt">
                        CƒÉn c·ª© bi√™n b·∫£n th∆∞∆°ng th·∫£o h·ª£p ƒë·ªìng ng√†y 31 th√°ng 8 nƒÉm 2025,<br>
                    </div>
                    <div class="document-basis text-indent" sytle ="margin-top: 10pt">
                        Theo ƒë·ªÅ ngh·ªã c·ªßa Ban QLDA t·∫°i T·ªù tr√¨nh s·ªë 1083/TTr-BQL ng√†y 01/9/2025 v√† B√°o c√°o th·∫©m ƒë·ªãnh s·ªë 1084/BC-HCKT ng√†y 01/9/2025 c·ªßa Ph√≤ng H·∫≠u c·∫ßn ‚Äì K·ªπ thu·∫≠t,
                    </div>
                    
                    <div class="document-decision" sytle ="margin-top: 20pt; margin-bottom: 20pt">QUY·∫æT ƒê·ªäNH</div>
                    
                    <div class="document-article text-indent">
                        <span class="document-article-title">ƒêi·ªÅu 1. </span><span class="document-article-content">Ph√™ duy·ªát k·∫øt qu·∫£ l·ª±a ch·ªçn nh√† th·∫ßu g√≥i th·∫ßu ${packageCode}: ${packageName} thu·ªôc d·ª± √°n: ${projectName} v·ªõi nh·ªØng n·ªôi dung sau:</span>
                    </div>
                    
                    <div class="document-article text-indent">
                        1.1. T√™n ƒë∆°n v·ªã tr√∫ng th·∫ßu: ${bidWinner}.<br>
                        ƒê·ªãa ch·ªâ: ${address}.
                    </div>
                    
                    <div class="document-article text-indent">
                        1.2. Gi√° tr√∫ng th·∫ßu: ${bidValue} ƒë·ªìng.<br>
                        (B·∫±ng ch·ªØ: ${valueInWords}).
                    </div>
                    
                    <div class="document-article text-indent">
                        1.3. Lo·∫°i h·ª£p ƒë·ªìng: H·ª£p ƒë·ªìng tr·ªçn g√≥i.
                    </div>
                    
                    <div class="document-article text-indent">
                        1.4. Th·ªùi gian th·ª±c hi·ªán: 360 ng√†y.
                    </div>
                    
                    <div class="document-article text-indent">
                        1.5. N·ªôi dung c√¥ng vi·ªác: ${packageDetails}.
                    </div>
                    
                    <div class="document-article text-indent">
                        <span class="document-article-title">ƒêi·ªÅu 2. </span><span class="document-article-content">T·ªï ch·ª©c th·ª±c hi·ªán</span><br>
                        Giao Ban Qu·∫£n l√Ω d·ª± √°n cƒÉn c·ª© c√°c n·ªôi dung ƒë∆∞·ª£c ph√™ duy·ªát t·∫°i ƒêi·ªÅu 1 Quy·∫øt ƒë·ªãnh n√†y, ti·∫øn h√†nh t·ªï ch·ª©c th·ª±c hi·ªán c√°c b∆∞·ªõc ti·∫øp theo ƒë√∫ng theo c√°c quy ƒë·ªãnh hi·ªán h√†nh c·ªßa Nh√† n∆∞·ªõc v√† B·ªô Qu·ªëc ph√≤ng.
                    </div>
                    
                    <div class="document-article text-indent">
                        <span class="document-article-title">ƒêi·ªÅu 3. </span><span class="document-article-content">Quy·∫øt ƒë·ªãnh n√†y c√≥ hi·ªáu l·ª±c k·ªÉ t·ª´ ng√†y k√Ω. Ban qu·∫£n l√Ω d·ª± √°n, ƒë∆°n v·ªã t∆∞ v·∫•n v√† c√°c ph√≤ng, ban c√≥ li√™n quan ch·ªãu tr√°ch nhi·ªám thi h√†nh Quy·∫øt ƒë·ªãnh n√†y./.</span>
                    </div>
                    
                    <div class="document-article text-indent">
                        <span class="document-article-title">„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§</span><span class="document-article-content">„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§</span>
                    </div>
                    
                    <table class="footer-table">
                        <tr>
                            <td class="footer-left">
                                <div class="document-recipient-title">N∆°i nh·∫≠n:</div>
                                <div class="footer-recipient">
                                    <div style ="font-size: 12 px">- Nh∆∞ ƒëi·ªÅu 3;</div>
                                    <div style ="font-size: 12 px">- C·ª•c T√†i ch√≠nh/BQP;</div>
                                    <div style ="font-size: 12 px">- C·ª•c Doanh tr·∫°i/TCHC-KT;</div>
                                    <div style ="font-size: 12 px">- Ph√≤ng Doanh tr·∫°i/CHC-KT;</div>
                                    <div style ="font-size: 12 px">- Ph√≤ng T√†i ch√≠nh/Qƒê34;</div>
                                    <div style ="font-size: 12 px">- Kho b·∫°c NN (Nere TT VƒêT);</div>
                                    <div style ="font-size: 12 px">- L∆∞u VT, DT. S10.</div>
                                </div>
                            </td>
                            <td class="footer-middle"></td>
                            <td class="footer-right">
                                <div class="footer-signature">
                                    <div class="signature-title">S∆Ø ƒêO√ÄN TR∆Ø·ªûNG</div>
                                    <div class="signature-name">„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§</div>
                                    <div class="signature-name">„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§</div>
                                    <div class="signature-name">„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§</div>
                                    <div class="signature-name">ƒê·∫°i t√° B√πi Th·∫ø T√†i</div>
                                </div>
                            </td>
                        </tr>
                    </table>
                `;
                
                // Hi·ªÉn th·ªã b√°o c√°o
                documentContent.innerHTML = reportContent;
                
                // Hi·ªÉn th·ªã ph·∫ßn xem tr∆∞·ªõc v√† ·∫©n form nh·∫≠p li·ªáu
                inputForm.style.display = 'none';
                previewContainer.style.display = 'block';
                storageContainer.style.display = 'none';
            });
            
            // Quay l·∫°i form nh·∫≠p li·ªáu
            backButton.addEventListener('click', function() {
                previewContainer.style.display = 'none';
                inputForm.style.display = 'block';
                storageContainer.style.display = 'none';
            });
            
            // Xem kho l∆∞u tr·ªØ
            viewStorageButton.addEventListener('click', function() {
                inputForm.style.display = 'none';
                previewContainer.style.display = 'none';
                storageContainer.style.display = 'block';
                renderStorageReports();
            });
            
            // Quay l·∫°i t·ª´ kho l∆∞u tr·ªØ
            storageBackButton.addEventListener('click', function() {
                storageContainer.style.display = 'none';
                inputForm.style.display = 'block';
                previewContainer.style.display = 'none';
            });
            
            // Xem kho l∆∞u tr·ªØ t·ª´ n√∫t trong ph·∫ßn xem tr∆∞·ªõc
            viewStorageFromPreview.addEventListener('click', function() {
                inputForm.style.display = 'none';
                previewContainer.style.display = 'none';
                storageContainer.style.display = 'block';
                renderStorageReports();
            });
            
            // T·∫£i xu·ªëng file Word
            downloadButton.addEventListener('click', function() {
                const content = documentContent.innerHTML;
                
                // T·∫°o n·ªôi dung HTML cho file Word
                const wordContent = `
                    <!DOCTYPE html>
                    <html lang="vi">
                    <head>
                        <meta charset="UTF-8">
                        <title>B√°o C√°o Th·∫ßu X√¢y D·ª±ng</title>
                        <style>
                            @page {
                                size: A4;
                                margin: 1cm;
                            }
                            body {
                                font-family: 'Times New Roman', serif;
                                line-height: 1.6;
                                font-size: 14pt;
                                margin: 0;
                                padding: 0;
                                width: 100%;
                                text-align: left;
                            }
                            .header-table {
                                width: 100%;
                                border-collapse: collapse;
                                border: none;
                                margin-bottom: 0;
                            }
                            .header-table td {
                                vertical-align: top;
                                padding: 0;
                                border: none;
                                height: 15pt;
                            }
                            .header-left {
                                width: 27%;
                                text-align: center;
                            }
                            .header-middle {
                                width: 5%;
                                text-align: center;
                            }
                            .header-right {
                                width: 68%;
                                text-align: right;
                            }
                            .footer-table {
                                width: 100%;
                                border-collapse: collapse;
                                border: none;
                                margin-top: 0;
                            }
                            .footer-table td {
                                vertical-align: top;
                                padding: 0;
                                border: none;
                                height: 15pt;
                            }
                            .footer-left {
                                width: 50%;
                                text-align: left;
                            }
                            .footer-middle {
                                width: 10%;
                                text-align: center;
                            }
                            .footer-right {
                                width: 40%;
                                text-align: right;
                            }
                            .footer-recipient {
                                margin-left: 13px;
                            }
                            .footer-signature {
                                text-align: center;
                            }
                            .signature-row {
                                height: 30pt;
                            }
                            .signature-title {
                                text-transform: uppercase;
                                font-weight: bold;
                                font-size: 14pt;
                                margin-bottom: 40pt;
                            }
                            .signature-name {
                                font-weight: bold;
                                font-size: 14pt;
                            }
                            .document-republic {
                                text-align: center;
                                font-weight: bold;
                                text-transform: uppercase;
                                margin-bottom: 5pt;
                                font-size: 13pt;
                            }
                            .document-independence {
                                text-align: center;
                                font-weight: bold;
                                margin-bottom: 0;
                                text-decoration: underline;
                            }
                            .document-number {
                                /* Vi·∫øt th∆∞·ªùng in th∆∞·ªùng */
                            }
                            .document-location-date {
                                text-align: center;
                            }
                            .document-title {
                                text-align: center;
                                font-weight: bold;
                                text-transform: uppercase;
                            }
                            .document-project {
                                text-align: center;
                                font-weight: bold;

                            }
                            .document-subtitle {
                                text-align: center;
                                font-weight: bold;
                            }
                            .document-commander {
                                text-align: center;
                                font-weight: bold;
                                text-transform: uppercase;
                            }
                            .document-basis {
                                text-align: left;
                                margin-bottom: 6px;
                                font-style: italic;
                                text-indent: 1cm;
                            }
                            .document-decision {
                                text-align: center;
                                font-weight: bold;
                                text-transform: uppercase;
                                margin: 20pt 0 10pt;
                            }
                            .document-article {
                                text-align: left;
                                margin-bottom: 10pt;
                                text-indent: 1cm;
                            }
                            .document-article-title {
                                font-weight: bold;
                                display: inline;
                            }
                            .document-article-content {
                                display: inline;
                            }
                            p {
                                text-align: left;
                                text-indent: 1cm;
                                margin-bottom: 10pt;
                            }
                            .left-align {
                                text-align: left;
                            }
                            .text-indent {
                                text-indent: 1cm;
                            }
                            .division-name {
                                font-weight: bold;
                                text-decoration: underline;
                                text-align: center;
                            }
                            .document-recipient-title {
                                font-weight: bold;
                                margin-bottom: 10px;
                                font-style: italic;
                                font-size: 15px;
                            }
                            .document-recipient-list {
                                margin-left: 20px;
                                font-size: 11px !important;
                            }
                        </style>
                    </head>
                    <body>
                        ${content}
                    </body>
                    </html>
                `;
                
                // T·∫°o file Word b·∫±ng c√°ch s·ª≠ d·ª•ng Blob v√† download
                const blob = new Blob(['\ufeff', wordContent], { type: 'application/msword' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'Bao_Cao_Thau_Xay_Dung.doc';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
            });
            
            // L∆∞u b√°o c√°o
            saveButton.addEventListener('click', function() {
                const projectName = document.getElementById('projectName').value || 'Kh√¥ng c√≥ t√™n';
                const packageCode = document.getElementById('packageCode').value;
                const bidWinner = document.getElementById('bidWinner').value;
                const content = documentContent.innerHTML;
                
                const newReport = {
                    id: Date.now().toString(),
                    projectName: projectName,
                    packageCode: packageCode,
                    bidWinner: bidWinner,
                    content: content,
                    timestamp: new Date().toISOString()
                };
                
                savedReports.push(newReport);
                localStorage.setItem('savedReports', JSON.stringify(savedReports));
                
                renderSavedReports();
                alert('B√°o c√°o ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!');
            });
        });
    </script>
</body>
</html>
